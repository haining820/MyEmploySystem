<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>企业用户信息编辑</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="../static/js/layui/css/layui.css"  media="all">
    <!-- 注意：如果你直接复制所有代码到本地，上述css路径需要改成你本地的 -->
</head>
<body>

<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
    <legend>企业用户信息</legend>
</fieldset>

<!--将用户信息显示在表单中-->
<form class="layui-form layui-form-pane" style="padding:10px 30px" lay-filter="showComInfo">

    <div class="layui-form-item">
        <div class="layui-inline">
            <label class="layui-form-label">账号</label>
            <div class="layui-input-inline">
                <input type="text" name="comAccountNum" lay-verify="required" autocomplete="off" class="layui-input" style="width:280px;" readonly>
            </div>
        </div>
        <div class="layui-inline" style="padding-left: 90px">
            <label class="layui-form-label" style="">密码</label>
            <div class="layui-input-inline">
                <input type="password" name="comPwd" lay-verify="required" autocomplete="off" class="layui-input" style="width:280px;" readonly>
            </div>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">用户名</label>
        <div class="layui-input-inline">
            <input type="text" name="comUserName" class="layui-input" style="width:692px" readonly>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">公司</label>
        <div class="layui-input-inline">
            <input type="text" name="comName" class="layui-input" style="width:692px" readonly>
        </div>
    </div>

    <div class="layui-form-item layui-form-text">
        <label class="layui-form-label" style="width:800px">公司介绍</label>
        <div class="layui-input-block">
            <textarea placeholder="如需添加内容，请点击编辑按钮。" name="comIntro" class="layui-textarea" style="width:800px; height:120px" readonly></textarea>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">地址</label>
        <div class="layui-input-block">
            <input type="text" name="comAddress" class="layui-input" style="width:692px" readonly>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">邮箱</label>
        <div class="layui-input-inline">
            <input type="text" name="comEmail" class="layui-input" style="width:692px" readonly>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">电话</label>
        <div class="layui-input-inline">
            <input type="text" name="comTel" class="layui-input" style="width:692px" readonly>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">公司网址</label>
        <div class="layui-input-inline">
            <input type="text" name="comWeb" class="layui-input" style="width:692px" readonly>
        </div>
    </div>

</form>

<div style="padding:10px 30px;">
    <button id="editCom" type="button" class="layui-btn layui-btn-normal">编辑</button>
</div>

<!--更新用户弹出层, padding: 20px 50px, 上下20,左右50-->
<div id="update-com-layer" style="display: none; padding: 20px 50px">
    <form id="update-com-form" class="layui-form layui-form-pane" lay-filter="update-com-form">
        <!--comId,comAccountNum,comPwd默认不显示-->
        <div class="layui-form-item" style="display: none">
            <label class="layui-form-label">comId</label>
            <div class="layui-input-block">
                <input type="text" name="comId" readonly>
            </div>
        </div>
        <div class="layui-form-item" style="display: none">
            <label class="layui-form-label">账号</label>
            <div class="layui-input-block">
                <input type="text" name="comAccountNum" readonly>
            </div>
        </div>
        <div class="layui-form-item" style="display: none">
            <label class="layui-form-label">登录密码</label>
            <div class="layui-input-block">
                <input type="text" name="comPwd" readonly>
            </div>
        </div>


        <div class="layui-form-item">
            <label class="layui-form-label">用户名</label>
            <div class="layui-input-block">
                <input type="text" name="comUserName" class="layui-input" lay-verify="required" autocomplete="off">
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label">所属公司</label>
            <div class="layui-input-block">
                <input type="text" name="comName" class="layui-input" lay-verify="required" autocomplete="off">
            </div>
        </div>

        <div class="layui-form-item layui-form-text">
            <label class="layui-form-label" style="width:780px">公司介绍</label>
            <div class="layui-input-block">
                <textarea placeholder="请输入内容" name="comIntro" class="layui-textarea" style="width:780px; height:120px"></textarea>
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label">地址</label>
            <div class="layui-input-block">
                <input type="text" name="comAddress" class="layui-input" lay-verify="required" autocomplete="off">
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label">电子邮箱</label>
            <div class="layui-input-block">
                <input type="text" name="comEmail" class="layui-input" lay-verify="email" autocomplete="off">
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label">联系电话</label>
            <div class="layui-input-block">
                <input type="text" name="comTel" class="layui-input" lay-verify="required" autocomplete="off">
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label">公司网址</label>
            <div class="layui-input-block">
                <input type="text" name="comWeb" class="layui-input" lay-verify="required" autocomplete="off">
            </div>
        </div>

        <div class="layui-form-item">
            <div class="layui-input-block">
                <br>
                <button class="layui-btn" lay-submit lay-filter="update-com-form-submit">提交</button>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <button class="layui-btn" type="button" id="exit">取消</button>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <button type="reset" class="layui-btn layui-btn-primary">重置</button>
            </div>
        </div>
    </form>
</div>

<script src="../static/js/layui/layui.js" charset="utf-8"></script>
<!-- 注意：如果你直接复制所有代码到本地，上述 JS 路径需要改成你本地的 -->
<script>

    // 编辑公司信息的表单操作
    layui.use('form', function(){
        var form = layui.form;
        var $ = layui.$;
        var data;  //
        $.ajax({
            type: "POST",
            url: 'http://localhost:8080/user/showComInfo',
            contentType: "application/json; charset=utf-8",
            dataType: 'json',
            success:function (obj) {
                data = obj.data;
                console.log(data);
                console.log(data.comUserName);
                form.val("showComInfo", { //formTest 即 class="layui-form" 所在元素属性 lay-filter="" 对应的值
                    "comAccountNum": data.comAccountNum
                    , "comPwd": "data.comPwd"
                    , "comUserName": data.comUserName
                    , "comName": data.comName
                    , "comIntro": data.comIntro
                    , "comAddress": data.comAddress
                    , "comEmail": data.comEmail
                    , "comTel": data.comTel
                    , "comWeb": data.comWeb
                });
                console.log(data.comWeb);

            }
        })

        $('body').on('click','#editCom',function(){
            console.log(data);
            console.log(data.comWeb);
            // 更新用户事件
            // 每次显示更新用户的表单前自动为表单填写该行的数据
            form.val('update-com-form', {
                "comId": data.comId,
                "comAccountNum": data.comAccountNum,
                "comPwd": data.comPwd,
                "comUserName": data.comUserName,
                "comName": data.comName,
                "comIntro": data.comIntro,
                "comAddress": data.comAddress,
                "comEmail": data.comEmail,
                "comTel": data.comTel,
                "comWeb": data.comWeb
            });
            // 显示更新用户表单的弹出层
            layer.open({
                type: 1,
                title: '更新用户信息',
                skin: 'layui-layer-molv',
                area: ['900px','600px'],
                content: $('#update-com-layer')
            });

            // 更新用户表单提交
            form.on('submit(update-com-form-submit)', function (data) {
                // ajax方式更新用户
                $.ajax({
                    url: "/edit/updateCom",
                    type: "PUT",
                    data: JSON.stringify(data.field),
                    contentType: "application/json; charset=utf-8",
                    dataType: 'json',
                    success: function (data) {
                        if (data.status == 1) {
                            layer.close(layer.index);
                            layer.msg('更新成功!',{icon:1,time:1000, shift: 1},function () {
                                location.reload();
                            });
                        } else {
                            layer.msg('更新失败!');
                        }
                    },
                    error: function () {
                        console.log("ajax error");
                    }
                });
                // 阻止表单跳转
                return false;
            });

            $('body').on('click','#exit',function(){
                layer.close(layer.index);
            })

        });
    });

</script>

</body>
</html>